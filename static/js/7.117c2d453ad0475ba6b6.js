webpackJsonp([7],{"+xHk":function(t,e){},"/Mf3":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("Ktbu"),n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"book-read container",attrs:{id:"book-read"},on:{click:t.getMousePos}},[o("el-dialog",{attrs:{title:"设置",visible:t.centerDialogVisible,width:"90%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[o("span",[t._v("字体大小:"+t._s(t.rangeValue)+"像素（px）")]),t._v(" "),o("mt-range",{attrs:{min:12,max:48,step:2,"bar-height":5},model:{value:t.rangeValue,callback:function(e){t.rangeValue=e},expression:"rangeValue"}}),t._v(" "),o("router-link",{attrs:{to:"/Novel/NovelReadTwo"}},[o("el-button",[t._v("滚动阅读")])],1),t._v(" "),o("router-link",{attrs:{to:"/Novel/NovelReadThree"}},[o("el-button",[t._v("翻页阅读")])],1),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),t._v(" "),o("vue-drawer-layout",{ref:"drawerLayout",attrs:{reverse:!0},on:{"mask-click":t.handleMaskClick}},[o("div",{staticClass:"drawer-book",attrs:{slot:"drawer",id:"drawer-book"},slot:"drawer"},[o("div",{staticClass:"block"},[o("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":100,"pager-count":5,layout:"prev, pager, next",total:t.chapterList.length},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),t._l(t.chapterListNew,function(e,a){return o("div",{key:e.title,class:a+100*(t.pageVal-1)==t.page?"blue-class":"red-class",on:{click:function(o){t.toChapterMui(e.title,a)}}},[o("mt-cell",{attrs:{title:e.title}})],1)})],2),t._v(" "),o("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[o("mt-header",{attrs:{title:t.title}},[o("router-link",{attrs:{slot:"left",to:"/Novel/NovelDetail"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1),t._v(" "),o("mt-button",{attrs:{slot:"right",icon:"more"},on:{click:t.more},slot:"right"})],1),t._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"book-read-main",attrs:{id:"book"}},[o("div",{staticClass:"page-loadmore"},[o("div",{ref:"wrapper",staticClass:"page-loadmore-wrapper",style:{height:t.wrapperHeight+"px"}},[o("mt-loadmore",{ref:"loadmore",attrs:{"bottom-method":t.loadBottom,"bottom-all-loaded":t.allLoaded},on:{"bottom-status-change":t.handleBottomChange}},[t._l(t.bodyText,function(e){return o("div",{class:t.preCon,style:{fontSize:t.rangeValue+"px ",fontFamily:t.myFontFamily},domProps:{innerHTML:t._s(e)}})}),t._v(" "),o("div",{staticClass:"mint-loadmore-bottom",attrs:{slot:"bottom"},slot:"bottom"},[o("span",{directives:[{name:"show",rawName:"v-show",value:"loading"!==t.bottomStatus,expression:"bottomStatus !== 'loading'"}],class:{"is-rotate":"drop"===t.bottomStatus}},[t._v("↑")]),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:"loading"===t.bottomStatus,expression:"bottomStatus === 'loading'"}]},[o("mt-spinner",{attrs:{type:"snake"}})],1)])],2)],1)])]),t._v(" "),o("mt-tabbar",{directives:[{name:"show",rawName:"v-show",value:t.showTabbar,expression:"showTabbar"}],staticStyle:{background:"none"}},[o("particle-effect-button",{attrs:{hidden:t.isHidden,color:"rgb(50, 186, 250)",duration:500,type:"triangle",drawStyle:"stroke"}},[o("mt-tab-item",{staticStyle:{width:"100%"},attrs:{id:"上一章"}},[o("el-button",{staticStyle:{float:"left"},attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:function(e){t.loadPrevMui(-1)}}},[t._v("上一章")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.sheZhi()}}},[t._v("设置")]),t._v(" "),o("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){t.loadPrevMui(1)}}},[t._v("下一章"),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)],1)],1)]),t._v(" "),o("div",{staticClass:"draggable",on:{click:function(e){t.main_log("点击了")}}},[o("mt-palette-button",{attrs:{content:"+",mainButtonStyle:"color:#fff;background-color:#26a2ff;"}},[o("div",{staticClass:"my-icon-button"})])],1)],1)},staticRenderFns:[]};var i=function(t){o("+xHk")},s=o("VU/8")(a.a,n,!1,i,"data-v-6f6da1c6",null);e.default=s.exports},Ktbu:function(t,e,o){"use strict";(function(t){var a=o("//Fk"),n=o.n(a),i=o("Zrlr"),s=o.n(i),r=o("wxAW"),l=o.n(r),c=o("BO1k"),u=o.n(c),h=o("mvHQ"),d=o.n(h),p=o("Dd8w"),m=o.n(p),g=o("mtWM"),f=(o.n(g),o("Au9i")),b=(o.n(f),o("NYxO")),v=o("K8K/"),y=o.n(v),k=o("FolY");e.a={name:"NovelReadTwo",components:{ParticleEffectButton:k.a},data:function(){return{showTabbar:!0,isHidden:!1,fontSlot:[{flex:1,values:["Microsoft YaHei","华文楷体","宋体","楷体","none","unset"],className:"slot1"}],fontFamily:"",preCon:{precon:!0},centerDialogVisible:!1,rangeValue:16,firstLoad:!0,allLoaded:!1,bottomStatus:"",wrapperHeight:0,fullscreenLoading:!1,title:"",chapterList:[],chapterListNew:[],page:0,bodyText:"",pageVal:1,currentPage:1,theParams:""}},computed:m()({},Object(b.c)(["bookDetail","myFontFamily"])),watch:{rangeValue:{handler:function(t,e){console.log(t),this.handleChange(t)}}},methods:{getMousePos:function(e){var o=e||window.event,a=(document.getElementById("book-read"),t("#book-read").width()),n=t("#book-read").height(),i=o.clientX,s=o.clientY,r=0;parseInt(i/a*100)>25&&parseInt(i/a*100)<75&&parseInt(s/n*100)>30&&parseInt(s/n*100)<70&&(console.log("x:"+parseInt(i/a*100)+",y:"+parseInt(s/n*100)),r=1),1==r&&this.main_log(),console.log(r)},theDraggabilly:function(){for(var t=document.querySelectorAll(".draggable"),e=[],o=0,a=t.length;o<a;o++){var n=t[o],i=new y.a(n,{containment:!0});e.push(i)}},main_log:function(t){var e=this;console.log(t),this.isHidden=!this.isHidden,0==this.isHidden?this.showTabbar=!0:setTimeout(function(){e.showTabbar=!1},500)},onFontChange:function(t,e){this.fontFamily="couriernew, courier,"+e[0],console.log(this.fontFamily)},handleChange:function(t){console.log(t);var e=JSON.parse(localStorage.getItem("czyBooks"));e.fontSize=t,console.log(e),e=d()(e),localStorage.removeItem("czyBooks"),localStorage.setItem("czyBooks",e)},bookReadIndex:function(){var t=this,e=JSON.parse(localStorage.getItem("czyBooks"));this.rangeValue=e.fontSize;for(var o=e.books.length,a=this.bookDetail,n=0,i=0;i<o;i++)e.books[i]._id==a&&(n=e.books[i].lastReadChapterIndex);setTimeout(function(){t.page=n},50)},changeBookshelf:function(){for(var t=JSON.parse(localStorage.getItem("czyBooks")),e=t.books.length,o=this.bookDetail,a=0;a<e;a++)t.books[a]._id==o&&(t.books[a].lastReadChapter=this.chapterList[this.page].title,t.books[a].lastReadChapterIndex=this.page);t=d()(t),localStorage.removeItem("czyBooks"),localStorage.setItem("czyBooks",t),console.log(JSON.parse(localStorage.getItem("czyBooks")))},handleBottomChange:function(t){this.bottomStatus=t},loadBottom:function(){var t=this;this.firstLoad?(setTimeout(function(){t.$refs.loadmore.onBottomLoaded()},30),setTimeout(function(){document.getElementsByClassName("page-loadmore-wrapper")[0].scrollTop=0},31),setTimeout(function(){t.firstLoad=!1},3e3)):setTimeout(function(){t.loadPrevMui(1),t.$refs.loadmore.onBottomLoaded()},200)},sheZhi:function(){this.centerDialogVisible=!0},openFullScreen:function(){var t=this;this.fullscreenLoading=!0,setTimeout(function(){t.fullscreenLoading=!1},500)},toChapterMui:function(t,e){this.allLoaded=!1,this.page=100*(this.pageVal-1)+e,this.getTextMui(this.chapterList),this.title=t,this.$refs.drawerLayout.toggle(!1),document.getElementById("book").scrollTop=0},handleCurrentChange:function(t){this.chapterListNew=this.chapterList.slice(100*(t-1),100*t),this.pageVal=t,setTimeout(function(){document.getElementById("drawer-book").scrollTop=document.getElementsByClassName("blue-class")[0].offsetTop},50)},handleMaskClick:function(){this.$refs.drawerLayout.toggle(!1)},more:function(){this.$refs.drawerLayout.toggle()},getLinkMui:function(t){var e=this;this.$mui.ajax({url:"http://api.zhuishushenqi.com/toc/"+t+"?view=chapters",data:{},async:!0,dataType:"json",crossDomain:!0,type:"get",timeout:1e4,scriptCharset:"utf-8",headers:{"Content-Type":"application/json"},success:function(t){e.$mui.toast("请求成功");var o=t;e.chapterList=o.chapters,e.title=e.chapterList[e.page].title,e.chapterListNew=e.chapterList.slice(0,100),e.getTextMui(e.chapterList)},error:function(t,o,a){console.log(o),e.$mui.toast("请求失败")}})},getTextMui:function(t){this.currentPage=parseInt(this.page/100)+1,this.handleCurrentChange(this.currentPage);var e=this;this.$mui.ajax({url:"http://chapter2.zhuishushenqi.com/chapter/"+encodeURIComponent(t[e.page].link)+"?k=2124b73d7e2e1945&t=1468223717)",data:{},async:!0,dataType:"json",crossDomain:!0,type:"get",timeout:1e4,scriptCharset:"utf-8",headers:{"Content-Type":"application/json"},success:function(t){e.$mui.toast("请求成功");var o=t;if(o.ok){if(o.chapter.body.indexOf("下载最新的追书神器app阅读本作")>-1)return void Object(f.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});if(o.chapter.body.indexOf("请安装最新版追书")>-1)return void Object(f.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});e.bodyText=o.chapter.body.split("\n").join("<br>");for(var a=e.bodyText.split("<br>"),n=[],i=0;i<a.length;i++)n.push(a[i]);e.bodyText=n,e.changeBookshelf(),setTimeout(function(){document.getElementsByClassName("page-loadmore-wrapper")[0].scrollTop=0},200)}},error:function(t,o,a){console.log(o),e.$mui.toast("请求失败")}})},loadPrevMui:function(t){this.allLoaded=!1,this.page=this.page+t,this.page<0?(this.page=0,Object(f.Toast)({message:"已经是第一章了...",position:"bottom",duration:2e3}),this.allLoaded=!1):this.page>=this.chapterList.length?(this.page=this.chapterList.length-1,Object(f.Toast)({message:"已经是最新章了...",position:"bottom",duration:2e3}),this.allLoaded=!0):(this.getTextMui(this.chapterList),this.title=this.chapterList[this.page].title,document.getElementsByClassName("page-loadmore-wrapper")[0].scrollTop=0,setTimeout(function(){document.getElementsByClassName("page-loadmore-wrapper")[0].scrollTop=0},100))},getNovelMui:function(){var t=this;this.$mui.ajax({url:"http://api.zhuishushenqi.com/toc?view=summary&book="+t.bookDetail,data:{},async:!0,dataType:"json",crossDomain:!0,type:"get",timeout:1e4,scriptCharset:"utf-8",headers:{"Content-Type":"application/json"},success:function(e){t.$mui.toast("请求成功");var o=e;console.log("theData"),console.log(o);var a=o.length>1?o[1]._id:o[0]._id,n=!0,i=!1,s=void 0;try{for(var r,l=u()(o);!(n=(r=l.next()).done);n=!0){var c=r.value;if("my176"===c.source){a=c._id;break}}}catch(t){i=!0,s=t}finally{try{!n&&l.return&&l.return()}finally{if(i)throw s}}t.getLinkMui(a)},error:function(e,o,a){console.log(o),t.$mui.toast("请求失败")}})},novel:function(){var t=this;new(function(){function e(){s()(this,e),this.sourceId=t.bookDetail,this.bookReadIndex2().then(this.getNovel2).then(this.getLink2).then(this.getText2).then(function(t){}).catch(function(t){console.log(t)})}return l()(e,[{key:"bookReadIndex2",value:function(){return new n.a(function(e,o){var a=JSON.parse(localStorage.getItem("czyBooks"));t.rangeValue=a.fontSize;for(var n=a.books.length,i=t.bookDetail,s=0,r=0;r<n;r++)a.books[r]._id==i&&(s=a.books[r].lastReadChapterIndex);setTimeout(function(){t.page=s,e()},50)})}},{key:"getNovel2",value:function(){return new n.a(function(e,o){t.$mui.ajax({url:"http://api.zhuishushenqi.com/toc?view=summary&book="+t.bookDetail,data:{},async:!0,dataType:"json",crossDomain:!0,type:"get",timeout:1e4,scriptCharset:"utf-8",headers:{"Content-Type":"application/json"},success:function(o){t.$mui.toast("请求成功");var a=o,n=a.length>1?a[1]._id:a[0]._id,i=!0,s=!1,r=void 0;try{for(var l,c=u()(a);!(i=(l=c.next()).done);i=!0){var h=l.value;if("my176"===h.source){n=h._id;break}}}catch(t){s=!0,r=t}finally{try{!i&&c.return&&c.return()}finally{if(s)throw r}}t.theParams=n,e()},error:function(e,o,a){console.log(o),t.$mui.toast("请求失败")}})})}},{key:"getLink2",value:function(){return new n.a(function(e,o){t.$mui.ajax({url:"http://api.zhuishushenqi.com/toc/"+t.theParams+"?view=chapters",data:{},async:!0,dataType:"json",crossDomain:!0,type:"get",timeout:1e4,scriptCharset:"utf-8",headers:{"Content-Type":"application/json"},success:function(o){t.$mui.toast("请求成功");var a=o;t.chapterList=a.chapters,t.title=t.chapterList[t.page].title,t.chapterListNew=t.chapterList.slice(0,100),e()},error:function(e,o,a){console.log(o),t.$mui.toast("请求失败")}})})}},{key:"getText2",value:function(){return new n.a(function(e,o){var a=t.chapterList;t.currentPage=parseInt(t.page/100)+1,t.handleCurrentChange(t.currentPage),t.$mui.ajax({url:"http://chapter2.zhuishushenqi.com/chapter/"+encodeURIComponent(a[t.page].link)+"?k=2124b73d7e2e1945&t=1468223717)",data:{},async:!0,dataType:"json",crossDomain:!0,type:"get",timeout:1e4,scriptCharset:"utf-8",headers:{"Content-Type":"application/json"},success:function(e){t.$mui.toast("请求成功");var o=e;if(o.ok){if(o.chapter.body.indexOf("下载最新的追书神器app阅读本作")>-1)return void Object(f.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});if(o.chapter.body.indexOf("请安装最新版追书")>-1)return void Object(f.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});t.bodyText=o.chapter.body.split("\n").join("<br>");for(var a=t.bodyText.split("<br>"),n=[],i=0;i<a.length;i++)n.push(a[i]);t.bodyText=n,t.changeBookshelf(),setTimeout(function(){document.getElementsByClassName("page-loadmore-wrapper")[0].scrollTop=0},200)}}})})}}]),e}())}},created:function(){var t=this;setTimeout(function(){t.novel()},80);var e=this;this.$mui.back=function(){e.$router.push("/Novel/NovelBookshelf")},setTimeout(function(){document.getElementsByClassName("page-loadmore-wrapper")[0].scrollTop=0},100)},mounted:function(){this.theDraggabilly(),this.bookReadIndex(),this.wrapperHeight=document.documentElement.clientHeight-this.$refs.wrapper.getBoundingClientRect().top},beforeRouteLeave:function(t,e,o){this.firstLoad=!0,o()}}}).call(e,o("7t+N"))}});