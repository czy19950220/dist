webpackJsonp([21],{YBYC:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("Dd8w"),s=o.n(n),r=o("NYxO"),i={name:"NovelBookshelf",data:function(){return{fullscreenLoading:!1,booksList:[],txt:"\n这个只是闲着没事做做看，由于需要跨域所以有以下几种方法\n一：只是在Vue的本地运行\n    做法==》在config文件夹下的index.js中的dev修改\n    proxyTable: {\n      '/api': {\n        target: 'http://api.zhuishushenqi.com',//设置你调用的接口域名和端口号\n        changeOrigin: true,     //跨域\n        pathRewrite: {\n          '^/api': '/'          //这里理解成用‘/api’代替target里面的地址，后面组件中我们掉接口时直接用api代替 比如我要调用'http://10.1.5.11:8080/xxx/duty?time=2017-07-07 14:57:22'，直接写‘/api/xxx/duty?time=2017-07-07 14:57:22’即可\n        }\n      },\n      '/chapter': {\n        target: 'http://chapter2.zhuishushenqi.com',//设置你调用的接口域名和端口号\n        changeOrigin: true,     //跨域\n        pathRewrite: {\n          '^/chapter': '/chapter'\n        }\n\n      }\n    },\n二：使用nginx跨域：\n    例子：\n    location /api/ {\n        proxy_pass   http://api.zhuishushenqi.com/;\n    }\n三：后台nodejs处理后再发过来(用的这个：var request=require('request');)\n    相当于做了类似nginx的事情，我用的是这个，例子：\n    router.route('/search').get(function (req,res) {\n    //console.log(req.query.link)\n    let query=encodeURIComponent(req.query.querySearchName);\n    //console.log(query)\n    //this.x={};\n    //例子： http://api.zhuishushenqi.com/book/fuzzy-search?query=%E5%A4%A7%E7%8E%8B&start=0&limit=20\n    let theUrl2=http://api.zhuishushenqi.com/book/fuzzy-search?query=query&start=0&limit=20\n    request(theUrl2, function (error, response, body) {\n        //console.log(theUrl2)\n        //console.log('error:', error); // Print the error if one occurred\n        //console.log('statusCode:', response && response.statusCode); // Print the response status code if a response was received\n        //console.log('body:', body); // Print the HTML for the Google homepage.\n        res.json({\n            body:body\n        })\n    });\n});"}},computed:s()({},Object(r.c)(["bookDetail"])),methods:s()({},Object(r.b)(["bookDetailChange"]),{toBookDetail:function(e){this.bookDetailChange(e),this.$router.push("/Novel/NovelDetail")},more:function(){console.log(1)},toSearch:function(){this.$router.push("/Novel/NovelSearch")},openFullScreen:function(){var e=this;this.fullscreenLoading=!0,setTimeout(function(){e.fullscreenLoading=!1},1200)},getBooks:function(){for(var e=this,t=JSON.parse(localStorage.getItem("czyBooks")),o=t.books,n=0,s=function(s){var r=e;e.$mui.ajax({url:"http://api.zhuishushenqi.com/book/"+t.books[s]._id,data:{},async:!0,dataType:"json",crossDomain:!0,type:"get",timeout:1e4,scriptCharset:"utf-8",headers:{"Content-Type":"application/json"},success:function(e){n++,o[s].newChapter2=e.lastChapter,n==t.books.length&&(r.booksList=o)},error:function(e,t,o){console.log(t),r.$mui.toast("请求失败")}})},r=0;r<t.books.length;r++)s(r)}}),mounted:function(){this.getBooks()},created:function(){var e=this;this.$mui.back=function(){e.$router.push("/Entertainment/EntertainmentCells")}}},a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"novel-bookshelf"},[o("mt-header",{attrs:{title:"我的书架"}},[o("router-link",{attrs:{slot:"left",to:"/Entertainment/EntertainmentCells"},slot:"left"},[o("mt-button",{attrs:{icon:"back"}},[e._v("返回")])],1),e._v(" "),o("mt-button",{staticClass:"novel-search",attrs:{slot:"right",icon:"search"},on:{click:function(t){e.toSearch()}},slot:"right"})],1),e._v(" "),o("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"novel-bookshelf-main"},e._l(e.booksList,function(t){return o("div",{staticClass:"booksList",on:{click:function(o){e.toBookDetail(t._id)}}},[o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.cover,expression:"book.cover"}],staticClass:"page-lazyload-image",attrs:{alt:""}}),e._v(" "),o("div",{staticClass:"book-title"},[e._v(e._s(t.title))]),e._v(" "),o("div",{staticClass:"book-lastChapter"},[e._v("阅读至： "+e._s(t.lastReadChapter))]),e._v(" "),o("div",{staticClass:"book-newChapter"},[e._v("更新至： "+e._s(t.newChapter2))])])}))],1)},staticRenderFns:[]};var l=o("VU/8")(i,a,!1,function(e){o("lJNS")},"data-v-605df365",null);t.default=l.exports},lJNS:function(e,t){}});