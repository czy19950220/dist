webpackJsonp([6],{D8Mg:function(t,e){},JVNl:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("yass"),i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"book-read container",attrs:{id:"book-read"},on:{click:t.getMousePos}},[a("el-dialog",{attrs:{title:"设置",visible:t.centerDialogVisible,width:"90%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[a("span",[t._v("字体大小:"+t._s(t.rangeValue)+"像素（px）")]),t._v(" "),a("mt-range",{attrs:{min:12,max:48,step:2,"bar-height":5},model:{value:t.rangeValue,callback:function(e){t.rangeValue=e},expression:"rangeValue"}}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1),t._v(" "),a("vue-drawer-layout",{ref:"drawerLayout",attrs:{enable:!1,reverse:!0},on:{"mask-click":t.handleMaskClick}},[a("div",{staticClass:"drawer-book",attrs:{slot:"drawer",id:"drawer-book"},slot:"drawer"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"","current-page":1,"page-size":100,"pager-count":5,layout:"prev, pager, next",total:t.chapterList.length},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),t._l(t.chapterListNew,function(e,o){return a("div",{key:e.title,class:o+100*(t.pageVal-1)==t.page?"blue-class":"red-class",on:{click:function(a){t.toChapter(e.title,o)}}},[a("mt-cell",{attrs:{title:e.title}})],1)})],2),t._v(" "),a("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[a("mt-header",{attrs:{title:t.title}},[a("router-link",{attrs:{slot:"left",to:"/NovelDev/NovelDetailDev"},slot:"left"},[a("mt-button",{attrs:{icon:"back"}},[t._v("返回")])],1),t._v(" "),a("mt-button",{attrs:{slot:"right",icon:"more"},on:{click:t.more},slot:"right"})],1),t._v(" "),a("div",{attrs:{id:"magazine",dir:"ltr"},on:{click:function(e){t.loadPrevClick()}}},t._l(t.newHtmlArr,function(e){return a("div",{staticClass:"novel-page",style:{fontSize:t.rangeValue+"px ",fontFamily:t.myFontFamily}},t._l(e,function(e){return a("div",{domProps:{innerHTML:t._s(e)}})}))})),t._v(" "),a("mt-tabbar",{directives:[{name:"show",rawName:"v-show",value:t.showTabbar,expression:"showTabbar"}],staticStyle:{background:"none","z-index":"100"}},[a("particle-effect-button",{attrs:{hidden:t.isHidden,color:"rgb(50, 186, 250)",duration:500,type:"triangle",drawStyle:"stroke"}},[a("mt-tab-item",{staticStyle:{width:"100%"},attrs:{id:"上一章"}},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:function(e){t.loadPrev(-1)}}},[t._v("上一章")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.sheZhi()}}},[t._v("设置")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){t.loadPrev(1)}}},[t._v("下一章"),a("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)],1)],1)]),t._v(" "),a("div",{staticClass:"draggable",on:{click:function(e){t.main_log()}}},[a("mt-palette-button",{attrs:{content:"+",mainButtonStyle:"color:#fff;background-color:#26a2ff;"}},[a("div",{staticClass:"my-icon-button"})])],1)],1)},staticRenderFns:[]};var n=function(t){a("D8Mg")},r=a("VU/8")(o.a,i,!1,n,"data-v-96e437c8",null);e.default=r.exports},yass:function(t,e,a){"use strict";(function(t){var o=a("//Fk"),i=a.n(o),n=a("Zrlr"),r=a.n(n),s=a("wxAW"),l=a.n(s),c=a("BO1k"),u=a.n(c),h=a("mvHQ"),d=a.n(h),g=a("Dd8w"),f=a.n(g),p=a("mtWM"),m=a.n(p),v=a("Au9i"),b=(a.n(v),a("NYxO")),y=a("K8K/"),k=a.n(y),w=a("FolY");a("KYLE");e.a={name:"NovelReadTwoDev",components:{ParticleEffectButton:w.a},data:function(){return{vueDrawerLayout:!1,loadCurrentPage:1,newHtmlArr:[],showTabbar:!0,isHidden:!1,fontSlot:[{flex:1,values:["Microsoft YaHei","华文楷体","宋体","楷体","none","unset"],className:"slot1"}],fontFamily:"",preCon:{precon:!0},centerDialogVisible:!1,rangeValue:16,firstLoad:1,allLoaded:!1,bottomStatus:"",wrapperHeight:0,pickerValue:"",fullscreenLoading:!1,title:"",chapterList:[],chapterListNew:[],page:0,bodyText:"",pageVal:1,theParams:"111"}},computed:f()({},Object(b.c)(["bookDetail","myFontFamily"])),watch:{rangeValue:{handler:function(t,e){this.handleChange(t)}}},methods:{loadPrevClick:function(e){if(!this.vueDrawerLayout){var a=e||window.event,o=(document.getElementById("book-read"),t("#magazine").width()),i=(t("#magazine").height(),a.clientX);a.clientY;this.loadCurrentPage==t("#magazine").turn("pages")?parseInt(i/o*100)>78&&this.loadPrev(1):1==this.loadCurrentPage&&parseInt(i/o*100)<23&&(this.loadPrev(-1),t("#magazine").turn("page",1))}},getMousePos:function(e){var a=e||window.event,o=(document.getElementById("book-read"),t("#book-read").width()),i=t("#book-read").height(),n=a.clientX,r=a.clientY;1==(parseInt(n/o*100)>25&&parseInt(n/o*100)<75&&parseInt(r/i*100)>30&&parseInt(r/i*100)<70?1:0)&&this.main_log()},theDraggabilly:function(){for(var t=document.querySelectorAll(".draggable"),e=[],a=0,o=t.length;a<o;a++){var i=t[a],n=new k.a(i,{containment:!0});e.push(n)}},main_log:function(){var t=this;this.isHidden=!this.isHidden,0==this.isHidden?this.showTabbar=!0:setTimeout(function(){t.showTabbar=!1},500)},onFontChange:function(t,e){this.fontFamily="couriernew, courier,"+e[0],console.log(this.fontFamily)},handleChange:function(t){var e=JSON.parse(localStorage.getItem("czyBooks"));e.fontSize=t,e=d()(e),localStorage.removeItem("czyBooks"),localStorage.setItem("czyBooks",e)},bookReadIndex:function(){var t=JSON.parse(localStorage.getItem("czyBooks"));this.rangeValue=t.fontSize;for(var e=t.books.length,a=this.bookDetail,o=0,i=0;i<e;i++)t.books[i]._id==a&&(o=t.books[i].lastReadChapterIndex);this.page=o},changeBookshelf:function(){for(var t=JSON.parse(localStorage.getItem("czyBooks")),e=t.books.length,a=this.bookDetail,o=0;o<e;o++)t.books[o]._id==a&&(t.books[o].lastReadChapter=this.chapterList[this.page].title,t.books[o].lastReadChapterIndex=this.page);t=d()(t),localStorage.removeItem("czyBooks"),localStorage.setItem("czyBooks",t)},handleBottomChange:function(t){this.bottomStatus=t},loadBottom:function(){var t=this;1==this.firstLoad?(setTimeout(function(){t.$refs.loadmore.onBottomLoaded()},30),setTimeout(function(){document.getElementsByClassName("page-loadmore-wrapper")[0].scrollTop=0},31),setTimeout(function(){t.firstLoad=0},3e3)):setTimeout(function(){t.loadPrev(1)},200)},sheZhi:function(){this.centerDialogVisible=!0},openFullScreen:function(){var t=this;this.fullscreenLoading=!0,setTimeout(function(){t.fullscreenLoading=!1},500)},toChapter:function(t,e){this.allLoaded=!1,this.page=100*(this.pageVal-1)+e,this.getText(this.chapterList),this.title=t,this.$refs.drawerLayout.toggle(!1),this.vueDrawerLayout=!1},handleCurrentChange:function(t){this.chapterListNew=this.chapterList.slice(100*(t-1),100*t),this.pageVal=t,setTimeout(function(){document.getElementById("drawer-book").scrollTop=document.getElementsByClassName("blue-class")[0].offsetTop},50)},handleMaskClick:function(){this.$refs.drawerLayout.toggle(!1),this.vueDrawerLayout=!1},more:function(){this.$refs.drawerLayout.toggle(),this.vueDrawerLayout=!0},getLink:function(t){var e=this,a="/api/toc/"+t+"?view=chapters";m.a.get(a).then(function(t){if(200==t.status){var a=t.data;e.chapterList=a.chapters,e.title=e.chapterList[e.page].title,e.chapterListNew=e.chapterList.slice(0,100),e.getText(e.chapterList)}}).catch(function(t){console.log(t),Object(v.Toast)({message:"资源没找到...",position:"bottom",duration:2e3})})},getText:function(e){var a=this;this.currentPage=parseInt(this.page/100)+1,this.handleCurrentChange(this.currentPage),m.a.get("/chapter/"+encodeURIComponent(e[this.page].link)+"?k=2124b73d7e2e1945&t=1468223717)").then(function(e){if(200==e.status){var o=e.data;if(o.ok){if(o.chapter.body.indexOf("下载最新的追书神器app阅读本作")>-1)return void Object(v.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});if(o.chapter.body.indexOf("请安装最新版追书")>-1)return void Object(v.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});a.bodyText=o.chapter.body.split("\n").join("<br>");for(var i=a.bodyText.split("<br>"),n=[],r=0;r<i.length;r++)n.push(i[r]);a.bodyText=n;for(var s=[],l=0;l<a.bodyText.length;l++)for(var c=a.bodyText[l].length,u=parseInt((t("#book-read").width()-22)/a.rangeValue),h=Math.ceil(c/u),d=a.bodyText[l],g=0;g<h;g++)if(0==g){var f='<div  style="font-size: '+a.rangeValue+"px;font-family: "+a.myFontFamily+';" class="txt-header">'+d.substring(0,u-2)+"</div>";s.push(f)}else{var p=u-2+(g-1)*u,m=u-2+g*u,b='<div style="font-size: '+a.rangeValue+"px;font-family: "+a.myFontFamily+';" class="txt-not-header">'+d.substring(p,m)+"</div>";s.push(b)}for(var y=[],k=parseInt((t("#book-read").height()-50)/(1.5*a.rangeValue)),w=0;w<s.length/k;w++)y[w]=s.slice(w*k,(w+1)*k);t("#magazine").width(),t("#magazine").height();!function e(){var a=t("#magazine").turn("pages");if(a<=1)for(var o=0;o<y.length;o++){for(var i="",n=0;n<y[o].length;n++)i+=y[o][n];var r=t("<div />").html('<div style="background: white;height: 100%">'+i+"</div>");t("#magazine").turn("addPage",r,o+1)}else t("#magazine").turn("removePage",a),e()}(),a.changeBookshelf()}}}).catch(function(t){console.log(t),Object(v.Toast)({message:"资源没找到",position:"bottom",duration:2e3})})},loadPrev:function(t){this.page=this.page+t,this.page<0?(this.page=0,Object(v.Toast)({message:"已经是第一章了...",position:"bottom",duration:2e3}),this.allLoaded=!1):this.page>=this.chapterList.length?(this.page=this.chapterList.length-1,Object(v.Toast)({message:"已经是最新章了...",position:"bottom",duration:2e3}),this.allLoaded=!0):(this.getText(this.chapterList),this.title=this.chapterList[this.page].title,setTimeout(function(){},100))},getNovel:function(){var t=this;m.a.get("/api/toc?view=summary&book="+this.bookDetail).then(function(e){if(200==e.status){var a=e.data,o=a.length>1?a[1]._id:a[0]._id,i=!0,n=!1,r=void 0;try{for(var s,l=u()(a);!(i=(s=l.next()).done);i=!0){var c=s.value;if("my176"===c.source){o=c._id;break}}}catch(t){n=!0,r=t}finally{try{!i&&l.return&&l.return()}finally{if(n)throw r}}t.getLink(o)}Object(v.Toast)({message:"加载成功",position:"bottom",duration:2e3})}).catch(function(t){Object(v.Toast)({message:"资源没找到...",position:"bottom",duration:2e3})})},novel:function(){var e=this;new(function(){function a(){r()(this,a),this.sourceId=e.bookDetail,this.getNovel2().then(this.getLink2).then(this.getText2).then(function(t){}).catch(function(t){console.log(t)})}return l()(a,[{key:"getNovel2",value:function(){var t=this;return new i.a(function(a,o){m.a.get("/api/toc?view=summary&book="+t.sourceId).then(function(t){if(200==t.status){var o=t.data,i=o.length>1?o[1]._id:o[0]._id,n=!0,r=!1,s=void 0;try{for(var l,c=u()(o);!(n=(l=c.next()).done);n=!0){var h=l.value;if("my176"===h.source){i=h._id;break}}}catch(t){r=!0,s=t}finally{try{!n&&c.return&&c.return()}finally{if(r)throw s}}e.theParams=i,a()}}).catch(function(t){Object(v.Toast)({message:"资源没找到...",position:"bottom",duration:2e3})})})}},{key:"getLink2",value:function(){return new i.a(function(t,a){var o="/api/toc/"+e.theParams+"?view=chapters";m.a.get(o).then(function(a){if(200==a.status){var o=a.data;e.chapterList=o.chapters,e.title=e.chapterList[e.page].title,e.chapterListNew=e.chapterList.slice(0,100),t()}}).catch(function(t){console.log(t),Object(v.Toast)({message:"资源没找到...",position:"bottom",duration:2e3})})})}},{key:"getText2",value:function(){return new i.a(function(a,o){var i=e.chapterList;e.currentPage=parseInt(e.page/100)+1,e.handleCurrentChange(e.currentPage),m.a.get("/chapter/"+encodeURIComponent(i[e.page].link)+"?k=2124b73d7e2e1945&t=1468223717)").then(function(a){if(200==a.status){var o=a.data;if(o.ok){if(o.chapter.body.indexOf("下载最新的追书神器app阅读本作")>-1)return void Object(v.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});if(o.chapter.body.indexOf("请安装最新版追书")>-1)return void Object(v.Toast)({message:"资源丢失了...",position:"bottom",duration:2e3});e.bodyText=o.chapter.body.split("\n").join("<br>");for(var i=e.bodyText.split("<br>"),n=[],r=0;r<i.length;r++)n.push(i[r]);e.bodyText=n,e.changeBookshelf();for(var s=[],l=0;l<e.bodyText.length;l++)for(var c=e.bodyText[l].length,u=Math.ceil(c/12),h=e.bodyText[l],d=0;d<u;d++){if(0==d){var g='<div class="txt-header">'+h.substring(0,10)+"</div>";10,s.push(g)}else{var f=10+12*(d-1),p=10+12*d,m='<div class="txt-not-header">'+h.substring(f,p)+"</div>";s.push(m)}}for(var b=[],y=0;y<s.length/14;y++)b[y]=s.slice(14*y,14*(y+1));e.newHtmlArr=b;var k=t("#magazine").width(),w=t("#magazine").height();e.$nextTick(function(){t("#magazine").turn({width:k,height:w,display:"single",acceleration:!0,autoCenter:!1,gradients:!0,disable:!1,when:{turning:function(a,o,i){o==t("#magazine").turn("pages")&&(console.log(o),e.loadCurrentPage=o)}}})}),setTimeout(function(){},200)}}}).catch(function(t){Object(v.Toast)({message:"资源没找到",position:"bottom",duration:2e3})})})}}]),a}())}},created:function(){this.novel()},mounted:function(){this.theDraggabilly(),this.bookReadIndex()},beforeRouteLeave:function(t,e,a){this.firstLoad=1,a()}}}).call(e,a("7t+N"))}});